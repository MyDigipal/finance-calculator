<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulateur Marketing Digital | MyDigipal</title>
  <meta name="description" content="Composez votre offre marketing digital sur-mesure avec MyDigipal. Calculateur interactif pour SEO, Google Ads et Paid Social.">

  <!-- Performance: DNS prefetch and preconnect for external resources -->
  <link rel="preconnect" href="https://cdn.tailwindcss.com">
  <link rel="preconnect" href="https://unpkg.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://n8n.mydigipal.com:5678">

  <!-- Performance: Preload critical resources -->
  <link rel="preload" href="https://unpkg.com/react@18/umd/react.production.min.js" as="script">
  <link rel="preload" href="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" as="script">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- NOTE: For production, pre-compile JSX with Vite/Webpack to eliminate runtime Babel transpilation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    /* Performance: will-change hints for GPU-accelerated animations */
    .fade-in {
      animation: fadeIn 0.3s ease-out;
      will-change: opacity, transform;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .disabled-section { opacity: 0.5; filter: grayscale(0.8); }
    .disabled-section .level-card { pointer-events: none; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .animate-spin {
      animation: spin 1s linear infinite;
      will-change: transform;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useMemo, useEffect, useCallback, memo } = React;

    // Performance: Memoized SVG icon components to prevent unnecessary re-renders
    const CheckIcon = memo(() => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="20,6 9,17 4,12"></polyline>
      </svg>
    ));

    const ChevronRightIcon = memo(() => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="9,18 15,12 9,6"></polyline>
      </svg>
    ));

    const ChevronDownIcon = memo(() => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="6,9 12,15 18,9"></polyline>
      </svg>
    ));

    const SparklesIcon = memo(() => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M12 3l1.912 5.813a2 2 0 001.275 1.275L21 12l-5.813 1.912a2 2 0 00-1.275 1.275L12 21l-1.912-5.813a2 2 0 00-1.275-1.275L3 12l5.813-1.912a2 2 0 001.275-1.275L12 3z"></path>
      </svg>
    ));

    const InfoIcon = memo(() => (
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
    ));

    const MailIcon = memo(() => (
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="2" y="4" width="20" height="16" rx="2"></rect>
        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
      </svg>
    ));

    const ArrowRightIcon = memo(() => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12,5 19,12 12,19"></polyline>
      </svg>
    ));

    const XIcon = memo(() => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    ));

    const LoaderIcon = memo(() => (
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="animate-spin">
        <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
      </svg>
    ));

    // Performance: Static style objects moved outside component to prevent recreation on each render
    const FORMATTED_CONTENT_STYLES = Object.freeze({
      roi: Object.freeze({
        intro: 'text-emerald-800',
        sectionTitle: 'font-semibold text-emerald-900 mb-2',
        item: 'text-emerald-800',
        bullet: 'text-emerald-500',
        conclusion: 'text-emerald-800 font-medium mt-4 pt-4 border-t border-emerald-200'
      }),
      default: Object.freeze({
        intro: 'text-indigo-800',
        sectionTitle: 'font-semibold text-indigo-900 mb-2',
        item: 'text-indigo-800',
        bullet: 'text-indigo-500',
        conclusion: 'text-indigo-800 font-medium mt-4 pt-4 border-t border-indigo-200'
      })
    });

    // Performance: Memoized component to prevent unnecessary re-renders
    const FormattedContent = memo(function FormattedContent({ content, variant = 'default' }) {
      const sections = content.sections || [];
      const styles = FORMATTED_CONTENT_STYLES[variant] || FORMATTED_CONTENT_STYLES.default;

      return (
        <div className="space-y-4">
          {content.intro && (
            <p className={styles.intro}>{content.intro}</p>
          )}

          {sections.map((section, sectionIdx) => (
            <div key={`section-${section.title}-${sectionIdx}`}>
              <h5 className={styles.sectionTitle}>{section.title}</h5>
              <ul className="space-y-1">
                {section.items.map((item, itemIdx) => (
                  <li key={`item-${sectionIdx}-${itemIdx}-${item.slice(0, 20)}`} className={`flex items-start gap-2 text-sm ${styles.item}`}>
                    <span className={`${styles.bullet} mt-0.5`}>‚Ä¢</span>
                    <span>{item}</span>
                  </li>
                ))}
              </ul>
            </div>
          ))}

          {content.conclusion && (
            <p className={styles.conclusion}>{content.conclusion}</p>
          )}
        </div>
      );
    });

    // Domain constants
    const DOMAINS = Object.freeze({
      SEO: 'seo',
      GOOGLE_ADS: 'google_ads',
      PAID_SOCIAL: 'paid_social'
    });

    const domainConfig = Object.freeze({
      [DOMAINS.SEO]: {
        id: DOMAINS.SEO,
        name: 'SEO',
        icon: 'üîç',
        description: 'R√©f√©rencement naturel et visibilit√© organique',
        color: 'indigo'
      },
      [DOMAINS.GOOGLE_ADS]: {
        id: DOMAINS.GOOGLE_ADS,
        name: 'Google Ads',
        icon: 'üìä',
        description: 'Publicit√© sur le r√©seau Google (Search, Display, YouTube)',
        color: 'blue'
      },
      [DOMAINS.PAID_SOCIAL]: {
        id: DOMAINS.PAID_SOCIAL,
        name: 'Paid Social',
        icon: 'üì±',
        description: 'Publicit√© sur les r√©seaux sociaux (Meta, LinkedIn, TikTok)',
        color: 'purple'
      }
    });

    // Management fee calculation for ads (% of budget with minimum)
    const MANAGEMENT_FEE_CONFIG = Object.freeze({
      [DOMAINS.GOOGLE_ADS]: { percentage: 15, minimum: 300 },
      [DOMAINS.PAID_SOCIAL]: { percentage: 15, minimum: 300 }
    });

    // Budget slider configuration
    const BUDGET_CONFIG = Object.freeze({
      min: 500,
      max: 50000,
      step: 500,
      default: 2000
    });

    // Performance: Freeze static data to prevent accidental mutations and enable engine optimizations
    const seoServices = Object.freeze([
      {
        id: 'audit',
        title: 'A. Audit SEO',
        description: 'La base de toute strat√©gie SEO efficace. Nous analysons votre site, votre march√© et vos concurrents pour identifier les opportunit√©s.',
        icon: 'üîç',
        isOneOff: true,
        detailedInfo: {
          title: 'Audit SEO - C\'est quoi exactement ?',
          content: {
            intro: 'Notre audit SEO comprend une analyse technique compl√®te de votre site et une √©tude des mots-cl√©s de votre secteur.',
            sections: [
              {
                title: 'Ce que nous analysons',
                items: [
                  'Vitesse de chargement (Core Web Vitals)',
                  'Structure des URLs et architecture du site',
                  'M√©tadonn√©es (titres, descriptions, balises H1-H6)',
                  'Maillage interne entre les pages',
                  'Compatibilit√© mobile et responsive design',
                  'Erreurs 404, redirections, liens cass√©s',
                  'Indexation et fichier sitemap.xml'
                ]
              },
              {
                title: 'Version Avanc√©e - En plus',
                items: [
                  '√âtude approfondie de vos concurrents',
                  'Analyse d\'un plus grand volume de mots-cl√©s',
                  'Plan d\'action prioris√© des corrections techniques',
                  'Roadmap des actions √† mener sur les prochains mois'
                ]
              }
            ],
            conclusion: 'Livrable : Rapport d\'audit complet avec recommandations actionnables.'
          }
        },
        roiInfo: {
          title: 'üìà Ce que √ßa vous apporte',
          content: {
            intro: 'L\'audit pose les fondations de votre strat√©gie. Sans lui, vous avancez √† l\'aveugle.',
            sections: [
              {
                title: 'ROI de la strat√©gie de mots-cl√©s',
                items: [
                  'Le SEO affiche le meilleur ROI tous canaux confondus : 1,389% (FirstPageSage 2025)',
                  'Le SEO convertit 3,5x mieux que le PPC dans la plupart des secteurs',
                  'Taux de conversion SEO : 3,2% vs 1,5% en publicit√© payante',
                  'Co√ªt d\'acquisition client organique : 660‚Ç¨ vs 1,185‚Ç¨ en paid'
                ]
              },
              {
                title: 'Pourquoi c\'est indispensable',
                items: [
                  'Identifier les "quick wins" : mots-cl√©s faciles √† gagner rapidement',
                  '√âviter d\'investir sur des mots-cl√©s trop concurrentiels',
                  'Comprendre ce que font vos concurrents (et faire mieux)',
                  'Avoir une feuille de route claire pour les mois √† venir'
                ]
              }
            ],
            conclusion: '‚Üí Sans audit, impossible de prioriser. Avec, vous savez exactement o√π mettre votre √©nergie.'
          }
        },
        levels: [
          { name: 'Basic', price: 300, features: ['Audit technique complet', '15-20 mots-cl√©s analys√©s', 'Recommandations g√©n√©rales'], recommended: 'Sites r√©cents ou petits budgets', color: 'blue' },
          { name: 'Avanc√©', price: 400, features: ['Audit approfondi', '√âtude des concurrents', '40+ mots-cl√©s analys√©s', 'Plan d\'action technique prioris√©'], recommended: 'Pour une vision strat√©gique compl√®te', color: 'indigo', popular: true }
        ]
      },
      {
        id: 'corrections',
        title: 'B. Corrections Techniques',
        description: 'Un site techniquement sain est la fondation d\'un bon r√©f√©rencement. Nous identifions et corrigeons les freins techniques.',
        icon: 'üîß',
        detailedInfo: {
          title: 'Corrections Techniques - C\'est quoi exactement ?',
          content: {
            intro: 'Un site techniquement sain est la fondation d\'un bon r√©f√©rencement. Nous utilisons des outils professionnels (Ahrefs, Screaming Frog) pour d√©tecter tous les probl√®mes.',
            sections: [
              {
                title: 'Types d\'erreurs d√©tect√©es',
                items: [
                  'Erreurs 404 et liens cass√©s',
                  'Probl√®mes de redirections (cha√Ænes, boucles)',
                  'Contenu dupliqu√©',
                  'Probl√®mes de canonicals',
                  'Erreurs de balisage Schema.org',
                  'Probl√®mes d\'indexation (noindex accidentels)',
                  'Vitesse de chargement lente'
                ]
              },
              {
                title: 'Nettoyage des backlinks toxiques',
                items: [
                  'Analyse de votre profil de liens',
                  'D√©saveu des backlinks spam via Google Search Console',
                  'Protection contre les p√©nalit√©s Google'
                ]
              }
            ],
            conclusion: 'Livrable : Rapport technique avec priorisation High/Medium/Low et guide d\'impl√©mentation.'
          }
        },
        roiInfo: {
          title: '‚ö° Ce que √ßa vous apporte',
          content: {
            intro: 'La vitesse et la sant√© technique de votre site impactent directement vos conversions et votre ranking.',
            sections: [
              {
                title: 'Impact de la vitesse sur vos conversions',
                items: [
                  'Un site qui charge en 1 seconde convertit 2,5x mieux qu\'un site qui charge en 5 secondes',
                  'Chaque seconde de d√©lai = -7% de conversions',
                  '53% des visiteurs mobiles quittent si chargement > 3 secondes',
                  'Vodafone : +8% de ventes avec 31% d\'am√©lioration du temps de chargement'
                ]
              },
              {
                title: 'Impact sur le r√©f√©rencement',
                items: [
                  'Sites conformes Core Web Vitals : -24% d\'abandon',
                  'Google p√©nalise les sites lents dans son algorithme',
                  'Les erreurs 404 et liens cass√©s nuisent √† l\'exploration par Google',
                  'Un site sain = meilleur crawl budget = plus de pages index√©es'
                ]
              }
            ],
            conclusion: '‚Üí Un site rapide et sans erreurs convertit mieux ET se positionne mieux. Double b√©n√©fice.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 100, features: ['Liste des erreurs d√©tect√©es', 'Export brut des probl√®mes'], recommended: 'Vous avez un webmaster en interne', color: 'blue' },
          { name: 'Avanc√©', price: 250, features: ['D√©tection des erreurs', 'Explications d√©taill√©es', 'Recommandations actionnables'], recommended: 'Comprendre et prioriser', color: 'indigo', popular: true },
          { name: 'Premium', price: 500, priceNote: '400-600‚Ç¨*', features: ['D√©tection compl√®te', 'Impl√©mentation par MyDigipal', 'Suivi des corrections'], recommended: 'On s\'en occupe pour vous', color: 'purple', footnote: '* Prix variable selon la complexit√© de votre CMS' }
        ]
      },
      {
        id: 'strategie',
        title: 'C. Strat√©gie SEO Central',
        description: 'Le pilotage strat√©gique continu de votre SEO : identification des opportunit√©s, optimisation des pages existantes et analyse de la concurrence.',
        icon: 'üéØ',
        detailedInfo: {
          title: 'Strat√©gie SEO Central - C\'est quoi exactement ?',
          content: {
            intro: 'Un accompagnement strat√©gique continu pour piloter votre SEO de mani√®re proactive, sans les corrections techniques ni la cr√©ation d\'articles (trait√©s s√©par√©ment).',
            sections: [
              {
                title: 'Recherche de mots-cl√©s en continu',
                items: [
                  'Identification des nouvelles opportunit√©s de mots-cl√©s',
                  'Suivi des positions et performances',
                  'Analyse des volumes de recherche et tendances',
                  'D√©tection des quick wins'
                ]
              },
              {
                title: 'Optimisation des pages existantes',
                items: [
                  'Audit r√©gulier des pages centrales',
                  'Recommandations de contenu √† modifier',
                  'Optimisation des balises et structure',
                  'Am√©lioration du maillage interne'
                ]
              },
              {
                title: 'Veille concurrentielle',
                items: [
                  'Analyse des strat√©gies concurrentes',
                  'Identification du contenu qui performe chez eux',
                  'D√©tection des opportunit√©s de positionnement',
                  'Benchmark r√©gulier du secteur'
                ]
              }
            ],
            conclusion: 'Un pilotage strat√©gique qui vous permet de toujours avoir une longueur d\'avance.'
          }
        },
        roiInfo: {
          title: 'üéØ Ce que √ßa vous apporte',
          content: {
            intro: 'Le SEO g√©n√®re des leads de bien meilleure qualit√© que les autres canaux marketing.',
            sections: [
              {
                title: 'Qualit√© du trafic SEO vs autres canaux',
                items: [
                  'Les leads SEO ont un taux de closing de 14,6% contre 1,7% pour le marketing traditionnel',
                  '60% des marketeurs disent que le SEO g√©n√®re les leads de meilleure qualit√©',
                  '70% des marketeurs confirment que le SEO g√©n√®re plus de ventes que le PPC',
                  'ROI moyen du SEO : 748% tous secteurs confondus'
                ]
              },
              {
                title: 'Avantage de la strat√©gie continue',
                items: [
                  'Identifier les opportunit√©s AVANT vos concurrents',
                  'R√©agir aux changements d\'algorithme Google',
                  'Capitaliser sur les tendances de recherche √©mergentes',
                  'Optimiser en continu = effet boule de neige sur le trafic'
                ]
              }
            ],
            conclusion: '‚Üí Une strat√©gie pilot√©e = des d√©cisions bas√©es sur la data, pas sur l\'intuition.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 200, features: ['5-10 pages suivies', 'Recherche mots-cl√©s mensuelle', 'Recommandations d\'optimisation'], recommended: 'Petits sites ou d√©marrage', color: 'blue' },
          { name: 'Avanc√©', price: 400, features: ['15-25 pages suivies', 'Recherche mots-cl√©s bi-mensuelle', 'Analyse concurrence trimestrielle', 'Plan d\'action prioris√©'], recommended: 'Sites en croissance', color: 'indigo', popular: true },
          { name: 'Premium', price: 600, features: ['40+ pages suivies', 'Veille mots-cl√©s continue', 'Analyse concurrence mensuelle', 'Analyse des tendances', 'Accompagnement strat√©gique d√©di√©'], recommended: 'Sites ambitieux ou concurrentiels', color: 'purple' }
        ]
      },
      {
        id: 'contenu',
        title: 'D. Contenu IA Optimis√©',
        description: 'Le contenu r√©gulier et de qualit√© est le carburant du SEO. Notre syst√®me IA vous permet de publier des articles optimis√©s √† grande √©chelle.',
        icon: '‚úçÔ∏è',
        hasAddon: true,
        detailedInfo: {
          title: 'Contenu IA Optimis√© - C\'est quoi exactement ?',
          content: {
            intro: 'La r√©gularit√© est cruciale : 2 articles/semaine = +68% de trafic organique apr√®s 6 mois (source: HubSpot 2024). Google favorise les sites actifs avec du contenu frais.',
            sections: [
              {
                title: 'Notre process de cr√©ation',
                items: [
                  'Identification des th√©matiques via analyse Ahrefs',
                  'Analyse des volumes de recherche et difficult√©',
                  'Structuration optimale (H1, H2, FAQ, tableaux)',
                  'R√©daction IA personnalis√©e √† votre ton',
                  'Relecture et validation humaine'
                ]
              },
              {
                title: 'Ce qui nous diff√©rencie',
                items: [
                  'Prompts personnalis√©s + relecture humaine',
                  'Densit√© naturelle de mots-cl√©s (1-2% max)',
                  'Minimum 1500 mots avec valeur ajout√©e',
                  'Monitoring performances + optimisations'
                ]
              },
              {
                title: 'Option Publication CMS (+100‚Ç¨/mois)',
                items: [
                  'Push automatique dans WordPress/Webflow',
                  'Articles en brouillon ou publi√©s directement',
                  'Gain de temps consid√©rable'
                ]
              }
            ],
            conclusion: 'Technologies : API Ahrefs, Claude Sonnet 4 / GPT-5, N8N automation, WordPress REST API'
          }
        },
        roiInfo: {
          title: 'üîó Ce que √ßa vous apporte',
          content: {
            intro: 'Le contenu est un investissement qui se valorise dans le temps. Contrairement √† la pub, il continue de g√©n√©rer du trafic sans budget additionnel.',
            sections: [
              {
                title: 'Impact du contenu sur votre visibilit√©',
                items: [
                  'Les pages en position #1 ont 3,8x plus de backlinks que les autres du top 10',
                  'R√©sultats visibles sous 3-6 mois en moyenne',
                  'Le contenu de qualit√© attire naturellement des liens',
                  '82% des gens ont une perception positive apr√®s lecture de contenu expert'
                ]
              },
              {
                title: 'Effet cumulatif du contenu',
                items: [
                  'Chaque article publi√© = un actif permanent',
                  'Les anciens articles continuent de g√©n√©rer du trafic',
                  '+68% de trafic organique avec 2 articles/semaine pendant 6 mois',
                  'Sans contenu r√©gulier, vous c√©dez du terrain √† vos concurrents'
                ]
              }
            ],
            conclusion: '‚Üí Le contenu SEO est un actif qui se valorise. La pub s\'arr√™te quand vous coupez le budget.'
          }
        },
        levels: [
          { name: '2 articles', price: 350, features: ['2 articles/mois', 'Optimis√©s SEO', 'Livr√©s en document'], recommended: 'D√©marrage ou budget limit√©', color: 'blue' },
          { name: '4 articles', price: 600, features: ['4 articles/mois', 'Optimis√©s SEO', 'Recherche mots-cl√©s incluse'], recommended: 'Croissance r√©guli√®re', color: 'indigo', popular: true },
          { name: '8 articles', price: 750, features: ['8 articles/mois', 'Optimis√©s SEO', 'Strat√©gie √©ditoriale compl√®te'], recommended: 'Dominer votre secteur', color: 'purple' }
        ]
      },
      {
        id: 'suivi',
        title: 'E. Suivi & Collaboration',
        description: 'Un accompagnement adapt√© √† vos besoins, du simple reporting mensuel √† un suivi rapproch√© avec r√©unions r√©guli√®res.',
        icon: 'ü§ù',
        detailedInfo: {
          title: 'Suivi & Collaboration - C\'est quoi exactement ?',
          content: {
            intro: 'Un accompagnement SEO efficace n√©cessite un suivi r√©gulier et une communication claire.',
            sections: [
              {
                title: 'Ce que comprend le reporting',
                items: [
                  '√âvolution du trafic organique',
                  'Positions des mots-cl√©s cibles',
                  'Nouveaux backlinks acquis',
                  'Erreurs techniques d√©tect√©es',
                  'Actions r√©alis√©es le mois pr√©c√©dent',
                  'Recommandations pour le mois suivant'
                ]
              },
              {
                title: 'Format des meetings',
                items: [
                  'Pr√©sentation des r√©sultats',
                  'Discussion des priorit√©s',
                  'Questions/r√©ponses',
                  'D√©finition des prochaines actions'
                ]
              },
              {
                title: 'Outils de collaboration',
                items: [
                  'Dashboard Looker Studio (optionnel)',
                  'Espace partag√© pour les livrables',
                  'Support email pour les questions urgentes'
                ]
              }
            ],
            conclusion: 'Notre engagement : Transparence totale sur les actions r√©alis√©es et les r√©sultats obtenus.'
          }
        },
        roiInfo: {
          title: 'üöÄ Ce que √ßa vous apporte',
          content: {
            intro: 'Au-del√† du ROI direct, le suivi r√©gulier garantit que votre investissement SEO porte ses fruits.',
            sections: [
              {
                title: 'B√©n√©fices du suivi r√©gulier',
                items: [
                  'R√©activit√© face aux probl√®mes (erreurs, p√©nalit√©s)',
                  'Ajustement de la strat√©gie selon les r√©sultats',
                  'Pas de mauvaise surprise : vous savez exactement o√π vous en √™tes',
                  'Alignement continu avec vos objectifs business'
                ]
              },
              {
                title: 'Impact business indirect',
                items: [
                  'Cr√©dibilit√© : vous comprenez ce qui est fait et pourquoi',
                  'Gain de temps : un interlocuteur d√©di√© qui conna√Æt votre dossier',
                  'Meilleure prise de d√©cision : bas√©e sur des donn√©es, pas des intuitions',
                  'Sans SEO actif, le budget pub peut augmenter de 400%'
                ]
              }
            ],
            conclusion: '‚Üí Le SEO sans suivi, c\'est comme un pilote sans tableau de bord. On avance, mais vers o√π ?'
          }
        },
        levels: [
          { name: 'Essentiel', price: 100, features: ['Reporting email mensuel', 'M√©triques cl√©s'], recommended: 'Autonome, peu de questions', color: 'blue' },
          { name: 'Avanc√©', price: 200, features: ['1 meeting tous les 2 mois', 'R√©cap + brief mensuel', 'Support email'], recommended: '√âchanges r√©guliers', color: 'indigo', popular: true },
          { name: 'Premium', price: 300, features: ['1 meeting/mois', 'Disponibilit√© email r√©active', 'Accompagnement strat√©gique'], recommended: 'Collaboration intensive', color: 'purple' }
        ]
      }
    ]);

    // Google Ads Services
    const googleAdsServices = Object.freeze([
      {
        id: 'audit_ads',
        title: 'A. Audit Google Ads',
        description: 'Analyse compl√®te de vos campagnes existantes pour identifier les optimisations et opportunit√©s de croissance.',
        icon: 'üîç',
        isOneOff: true,
        detailedInfo: {
          title: 'Audit Google Ads - C\'est quoi exactement ?',
          content: {
            intro: 'Un diagnostic complet de votre compte Google Ads pour identifier les fuites de budget et les opportunit√©s manqu√©es.',
            sections: [
              {
                title: 'Ce que nous analysons',
                items: [
                  'Structure du compte (campagnes, groupes d\'annonces)',
                  'Qualit√© des mots-cl√©s et Quality Score',
                  'Performance des annonces (CTR, taux de conversion)',
                  'Param√®tres d\'ench√®res et strat√©gies utilis√©es',
                  'Extensions d\'annonces configur√©es',
                  'Audiences et ciblage g√©ographique',
                  'Suivi des conversions et attribution'
                ]
              },
              {
                title: 'Version Avanc√©e - En plus',
                items: [
                  'Analyse concurrentielle via Auction Insights',
                  '√âtude des termes de recherche sur 6 mois',
                  'Recommandations budg√©taires optimales',
                  'Roadmap d\'optimisation prioris√©e'
                ]
              }
            ],
            conclusion: 'Livrable : Rapport d\'audit avec quick wins et plan d\'action sur 3 mois.'
          }
        },
        roiInfo: {
          title: 'üìà Ce que √ßa vous apporte',
          content: {
            intro: 'Un audit permet souvent d\'√©conomiser 20-40% du budget tout en am√©liorant les performances.',
            sections: [
              {
                title: 'ROI typique d\'un audit',
                items: [
                  'Identification des mots-cl√©s qui gaspillent votre budget',
                  'Am√©lioration du Quality Score = co√ªts par clic r√©duits',
                  'D√©tection des opportunit√©s de mots-cl√©s manqu√©es',
                  'Optimisation des ench√®res selon la valeur r√©elle des conversions'
                ]
              },
              {
                title: 'Exemples concrets',
                items: [
                  'Client e-commerce : -35% de co√ªt par acquisition apr√®s audit',
                  'Client B2B : +50% de leads qualifi√©s √† budget constant',
                  'Client local : doublement du ROI en optimisant le ciblage g√©o'
                ]
              }
            ],
            conclusion: '‚Üí L\'audit se rentabilise g√©n√©ralement d√®s le premier mois d\'optimisation.'
          }
        },
        levels: [
          { name: 'Basic', price: 300, features: ['Analyse de la structure', 'Audit des mots-cl√©s', 'Recommandations g√©n√©rales'], recommended: 'Comptes < 2000‚Ç¨/mois', color: 'blue' },
          { name: 'Avanc√©', price: 500, features: ['Analyse compl√®te', '√âtude concurrentielle', 'Audit des conversions', 'Plan d\'action prioris√©'], recommended: 'Comptes > 2000‚Ç¨/mois', color: 'indigo', popular: true }
        ]
      },
      {
        id: 'setup_ads',
        title: 'B. Setup de Campagnes',
        description: 'Cr√©ation et configuration de vos campagnes Google Ads avec une structure optimis√©e d√®s le d√©part.',
        icon: '‚öôÔ∏è',
        isOneOff: true,
        detailedInfo: {
          title: 'Setup de Campagnes - C\'est quoi exactement ?',
          content: {
            intro: 'La cr√©ation from scratch d\'un compte Google Ads bien structur√©, ou la restructuration compl√®te d\'un compte existant.',
            sections: [
              {
                title: 'Ce que nous configurons',
                items: [
                  'Structure de compte optimale (campagnes, groupes d\'annonces)',
                  'Recherche et s√©lection des mots-cl√©s',
                  'R√©daction des annonces (RSA, extensions)',
                  'Configuration du ciblage (g√©o, audiences, appareils)',
                  'Param√©trage des ench√®res et budgets',
                  'Configuration du suivi des conversions'
                ]
              },
              {
                title: 'Version Premium - En plus',
                items: [
                  'Setup campagnes Display/YouTube',
                  'Configuration du remarketing',
                  'Audiences personnalis√©es et similaires',
                  'Tests A/B des annonces d√®s le lancement'
                ]
              }
            ],
            conclusion: 'Livrable : Compte pr√™t √† √™tre activ√© avec documentation compl√®te.'
          }
        },
        roiInfo: {
          title: 'üöÄ Ce que √ßa vous apporte',
          content: {
            intro: 'Un setup bien fait √©vite des mois de corrections et de budget gaspill√©.',
            sections: [
              {
                title: 'Avantages d\'un setup professionnel',
                items: [
                  'Quality Score √©lev√© d√®s le d√©part = CPCs plus bas',
                  'Structure scalable pour accompagner votre croissance',
                  'Pas de temps perdu √† corriger des erreurs de d√©butant',
                  'Conversions track√©es correctement d√®s jour 1'
                ]
              },
              {
                title: 'Ce que √ßa √©vite',
                items: [
                  'Budget gaspill√© sur des mots-cl√©s non pertinents',
                  'Annonces refus√©es pour non-conformit√©',
                  'Donn√©es de conversion incorrectes pendant des mois',
                  'Structure de compte impossible √† optimiser'
                ]
              }
            ],
            conclusion: '‚Üí Un bon setup est un investissement qui se rentabilise sur toute la dur√©e de vie du compte.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 400, features: ['1-2 campagnes Search', 'Recherche mots-cl√©s', '3 groupes d\'annonces', 'Suivi conversions basique'], recommended: 'D√©marrage simple', color: 'blue' },
          { name: 'Avanc√©', price: 700, features: ['3-5 campagnes Search', 'Recherche approfondie', 'Extensions compl√®tes', 'Remarketing basique'], recommended: 'Strat√©gie compl√®te', color: 'indigo', popular: true },
          { name: 'Premium', price: 1200, features: ['Campagnes Search + Display', 'YouTube Ads', 'Remarketing avanc√©', 'Audiences personnalis√©es', 'A/B testing'], recommended: 'Pr√©sence multi-canal', color: 'purple' }
        ]
      },
      {
        id: 'gestion_ads',
        title: 'C. Gestion Mensuelle',
        description: 'Optimisation continue de vos campagnes pour maximiser votre ROI publicitaire.',
        icon: 'üìà',
        hasBudgetFee: true,
        detailedInfo: {
          title: 'Gestion Mensuelle - C\'est quoi exactement ?',
          content: {
            intro: 'Un accompagnement mensuel pour optimiser vos campagnes et maximiser chaque euro investi.',
            sections: [
              {
                title: 'Ce que nous faisons chaque mois',
                items: [
                  'Ajustement des ench√®res selon les performances',
                  'Ajout/exclusion de mots-cl√©s',
                  'Tests et optimisation des annonces',
                  'Gestion des audiences et remarketing',
                  'Optimisation du budget entre campagnes',
                  'Veille concurrentielle'
                ]
              },
              {
                title: 'Reporting inclus',
                items: [
                  'Dashboard temps r√©el',
                  'Rapport mensuel comment√©',
                  'Analyse des tendances',
                  'Recommandations d\'√©volution'
                ]
              }
            ],
            conclusion: 'Note : Les frais de gestion sont calcul√©s en % de votre budget publicitaire (minimum 300‚Ç¨/mois).'
          }
        },
        roiInfo: {
          title: 'üí∞ Ce que √ßa vous apporte',
          content: {
            intro: 'Une gestion active am√©liore typiquement le ROI de 30-50% vs un compte laiss√© en autopilote.',
            sections: [
              {
                title: 'Impact de la gestion continue',
                items: [
                  'R√©duction progressive des CPCs gr√¢ce √† l\'optimisation',
                  'Am√©lioration constante du taux de conversion',
                  'Adaptation aux √©volutions du march√© et de la concurrence',
                  'D√©couverte de nouvelles opportunit√©s de croissance'
                ]
              },
              {
                title: 'Comparaison avec/sans gestion',
                items: [
                  'Compte non g√©r√© : performance qui d√©cline avec le temps',
                  'Compte g√©r√© : am√©lioration continue des m√©triques',
                  'ROI moyen Google Ads : 200% (2‚Ç¨ gagn√©s pour 1‚Ç¨ investi)',
                  'ROI avec gestion optimis√©e : jusqu\'√† 400-800%'
                ]
              }
            ],
            conclusion: '‚Üí Les frais de gestion sont largement compens√©s par l\'am√©lioration des performances.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 0, features: ['Optimisations hebdomadaires', 'Ajustement des ench√®res', 'Rapport mensuel'], recommended: 'Budgets < 3000‚Ç¨/mois', color: 'blue', budgetBased: true },
          { name: 'Avanc√©', price: 200, features: ['Optimisations bi-hebdomadaires', 'Tests A/B continus', 'Rapport d√©taill√©', '1 call/mois'], recommended: 'Budgets 3000-10000‚Ç¨/mois', color: 'indigo', popular: true, budgetBased: true },
          { name: 'Premium', price: 400, features: ['Optimisations continues', 'Strat√©gies avanc√©es', 'Reporting personnalis√©', '2 calls/mois', 'Support prioritaire'], recommended: 'Budgets > 10000‚Ç¨/mois', color: 'purple', budgetBased: true }
        ]
      },
      {
        id: 'reporting_ads',
        title: 'D. Reporting & Analytics',
        description: 'Dashboards personnalis√©s et analyses approfondies pour piloter vos investissements.',
        icon: 'üìä',
        detailedInfo: {
          title: 'Reporting & Analytics - C\'est quoi exactement ?',
          content: {
            intro: 'Des outils de reporting sur-mesure pour suivre vos KPIs et prendre des d√©cisions √©clair√©es.',
            sections: [
              {
                title: 'Ce que nous mettons en place',
                items: [
                  'Dashboard Looker Studio personnalis√©',
                  'Int√©gration des donn√©es Google Ads, Analytics, CRM',
                  'Visualisations claires et actionnables',
                  'Alertes automatiques sur les anomalies'
                ]
              },
              {
                title: 'Analyses incluses',
                items: [
                  'Attribution multi-touch',
                  'Analyse du parcours client',
                  'Segmentation des audiences',
                  'Comparaisons p√©riode vs p√©riode'
                ]
              }
            ],
            conclusion: 'Livrable : Acc√®s √† un dashboard en temps r√©el + exports automatis√©s.'
          }
        },
        roiInfo: {
          title: 'üìà Ce que √ßa vous apporte',
          content: {
            intro: 'Des donn√©es claires permettent de prendre de meilleures d√©cisions et d\'optimiser plus rapidement.',
            sections: [
              {
                title: 'B√©n√©fices du reporting avanc√©',
                items: [
                  'Visibilit√© en temps r√©el sur vos performances',
                  'Identification rapide des probl√®mes',
                  'Meilleure allocation budg√©taire',
                  'Justification du ROI aupr√®s de la direction'
                ]
              },
              {
                title: 'Ce que vous gagnez',
                items: [
                  'Temps : plus besoin de compiler les donn√©es manuellement',
                  'R√©activit√© : d√©tection imm√©diate des anomalies',
                  'Confiance : d√©cisions bas√©es sur la data, pas l\'intuition'
                ]
              }
            ],
            conclusion: '‚Üí Un bon reporting est le GPS de votre strat√©gie publicitaire.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 150, features: ['Dashboard standard', 'KPIs principaux', 'Mise √† jour quotidienne'], recommended: 'Suivi basique', color: 'blue' },
          { name: 'Avanc√©', price: 300, features: ['Dashboard personnalis√©', 'Multi-sources', 'Alertes automatiques', 'Analyse mensuelle'], recommended: 'Pilotage avanc√©', color: 'indigo', popular: true }
        ]
      }
    ]);

    // Paid Social Services
    const paidSocialServices = Object.freeze([
      {
        id: 'audit_social',
        title: 'A. Audit Social Ads',
        description: 'Analyse de vos campagnes publicitaires sur les r√©seaux sociaux (Meta, LinkedIn, TikTok).',
        icon: 'üîç',
        isOneOff: true,
        detailedInfo: {
          title: 'Audit Social Ads - C\'est quoi exactement ?',
          content: {
            intro: 'Un diagnostic complet de vos campagnes sur Meta (Facebook/Instagram), LinkedIn ou TikTok.',
            sections: [
              {
                title: 'Ce que nous analysons',
                items: [
                  'Structure des campagnes et ensembles de publicit√©s',
                  'Qualit√© des audiences cibl√©es',
                  'Performance des cr√©atifs (images, vid√©os, carrousels)',
                  'Param√®tres du Pixel et suivi des conversions',
                  'Strat√©gies d\'ench√®res utilis√©es',
                  'R√©partition budg√©taire entre plateformes'
                ]
              },
              {
                title: 'Version Avanc√©e - En plus',
                items: [
                  'Benchmark sectoriel des performances',
                  'Analyse des audiences similaires',
                  'Audit cr√©atif approfondi avec recommandations',
                  'Roadmap d\'optimisation sur 3 mois'
                ]
              }
            ],
            conclusion: 'Livrable : Rapport d\'audit avec quick wins et recommandations cr√©atives.'
          }
        },
        roiInfo: {
          title: 'üìà Ce que √ßa vous apporte',
          content: {
            intro: 'Les campagnes Social Ads mal optimis√©es peuvent gaspiller jusqu\'√† 50% du budget.',
            sections: [
              {
                title: 'ROI typique d\'un audit Social',
                items: [
                  'Identification des audiences qui ne convertissent pas',
                  'D√©tection des cr√©atifs sous-performants',
                  'Optimisation du Pixel pour un meilleur retargeting',
                  'Am√©lioration de l\'attribution des conversions'
                ]
              },
              {
                title: 'R√©sultats observ√©s',
                items: [
                  'R√©duction moyenne de 25% du co√ªt par lead',
                  'Am√©lioration du ROAS de 40% en moyenne',
                  'Meilleure qualit√© des leads g√©n√©r√©s'
                ]
              }
            ],
            conclusion: '‚Üí Un audit r√©v√®le souvent des opportunit√©s d\'optimisation majeures.'
          }
        },
        levels: [
          { name: 'Basic', price: 300, features: ['Audit 1 plateforme', 'Analyse des campagnes', 'Recommandations g√©n√©rales'], recommended: 'Une seule plateforme', color: 'blue' },
          { name: 'Avanc√©', price: 500, features: ['Audit multi-plateformes', 'Benchmark sectoriel', 'Audit cr√©atif', 'Plan d\'action d√©taill√©'], recommended: 'Strat√©gie cross-platform', color: 'indigo', popular: true }
        ]
      },
      {
        id: 'setup_social',
        title: 'B. Setup de Campagnes',
        description: 'Cr√©ation et configuration de vos campagnes publicitaires sur les r√©seaux sociaux.',
        icon: '‚öôÔ∏è',
        isOneOff: true,
        detailedInfo: {
          title: 'Setup Campagnes Social - C\'est quoi exactement ?',
          content: {
            intro: 'La mise en place compl√®te de votre pr√©sence publicitaire sur Meta, LinkedIn et/ou TikTok.',
            sections: [
              {
                title: 'Ce que nous configurons',
                items: [
                  'Cr√©ation/v√©rification du Business Manager',
                  'Installation et configuration du Pixel',
                  'Cr√©ation des audiences (custom, lookalike)',
                  'Structure des campagnes (awareness, consideration, conversion)',
                  'Param√©trage des √©v√©nements de conversion',
                  'Configuration du catalogue produits (e-commerce)'
                ]
              },
              {
                title: 'Version Premium - En plus',
                items: [
                  'Setup multi-plateformes',
                  'Int√©gration CRM pour audiences',
                  'Configuration API Conversions',
                  'Strat√©gie de test A/B'
                ]
              }
            ],
            conclusion: 'Livrable : Compte publicitaire pr√™t avec documentation et guide d\'utilisation.'
          }
        },
        roiInfo: {
          title: 'üöÄ Ce que √ßa vous apporte',
          content: {
            intro: 'Un setup professionnel garantit des donn√©es fiables et des campagnes efficaces d√®s le d√©part.',
            sections: [
              {
                title: 'Avantages d\'un setup professionnel',
                items: [
                  'Pixel correctement configur√© = donn√©es de conversion fiables',
                  'Audiences bien segment√©es = meilleur ciblage',
                  'Structure scalable pour accompagner votre croissance',
                  'Conformit√© avec les politiques des plateformes'
                ]
              },
              {
                title: 'Erreurs √©vit√©es',
                items: [
                  'Pixel mal install√© (donn√©es perdues pendant des mois)',
                  'Audiences trop larges ou trop restreintes',
                  'Budget mal r√©parti entre les phases du funnel',
                  'Compte publicitaire bloqu√© pour non-conformit√©'
                ]
              }
            ],
            conclusion: '‚Üí Un bon setup est la fondation de campagnes rentables.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 400, features: ['Setup 1 plateforme', 'Configuration Pixel', 'Audiences de base', '1 campagne test'], recommended: 'D√©marrage simple', color: 'blue' },
          { name: 'Avanc√©', price: 700, features: ['Setup 2 plateformes', 'Audiences avanc√©es', 'API Conversions', '2 campagnes test'], recommended: 'Strat√©gie compl√®te', color: 'indigo', popular: true },
          { name: 'Premium', price: 1000, features: ['Setup toutes plateformes', 'Int√©gration CRM', 'Catalogue produits', 'Formation √©quipe'], recommended: 'E-commerce / Scale-up', color: 'purple' }
        ]
      },
      {
        id: 'gestion_social',
        title: 'C. Gestion Mensuelle',
        description: 'Optimisation continue de vos campagnes Social Ads pour maximiser votre ROI.',
        icon: 'üìà',
        hasBudgetFee: true,
        detailedInfo: {
          title: 'Gestion Mensuelle - C\'est quoi exactement ?',
          content: {
            intro: 'Un accompagnement mensuel pour optimiser vos campagnes et maintenir des performances √©lev√©es.',
            sections: [
              {
                title: 'Ce que nous faisons chaque mois',
                items: [
                  'Optimisation des audiences (refresh, exclusions)',
                  'Rotation et test des cr√©atifs',
                  'Ajustement des ench√®res et budgets',
                  'Gestion du retargeting',
                  'Scaling des campagnes performantes',
                  'Veille sur les nouveaut√©s des plateformes'
                ]
              },
              {
                title: 'Reporting inclus',
                items: [
                  'Suivi des KPIs cl√©s (ROAS, CPA, CPM)',
                  'Rapport mensuel avec insights',
                  'Recommandations cr√©atives',
                  'Benchmark vs secteur'
                ]
              }
            ],
            conclusion: 'Note : Les frais de gestion sont calcul√©s en % de votre budget publicitaire (minimum 300‚Ç¨/mois).'
          }
        },
        roiInfo: {
          title: 'üí∞ Ce que √ßa vous apporte',
          content: {
            intro: 'Les algorithmes Social Ads √©voluent constamment. Une gestion active est essentielle.',
            sections: [
              {
                title: 'Impact de la gestion continue',
                items: [
                  'Lutte contre la fatigue publicitaire',
                  'Adaptation aux changements d\'algorithmes',
                  'Optimisation continue des co√ªts d\'acquisition',
                  'D√©couverte de nouvelles audiences rentables'
                ]
              },
              {
                title: 'R√©sultats typiques',
                items: [
                  'ROAS moyen Meta Ads : 4x avec gestion optimis√©e',
                  'R√©duction de 30% du CPA sur 6 mois',
                  'Augmentation de 50% du volume de conversions'
                ]
              }
            ],
            conclusion: '‚Üí Sans gestion active, les performances d√©clinent en 2-3 semaines.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 0, features: ['Optimisations hebdomadaires', 'Rotation des cr√©atifs', 'Rapport mensuel'], recommended: 'Budgets < 3000‚Ç¨/mois', color: 'blue', budgetBased: true },
          { name: 'Avanc√©', price: 200, features: ['Optimisations bi-hebdo', 'Tests cr√©atifs A/B', 'Rapport d√©taill√©', '1 call/mois'], recommended: 'Budgets 3000-10000‚Ç¨/mois', color: 'indigo', popular: true, budgetBased: true },
          { name: 'Premium', price: 400, features: ['Optimisations continues', 'Creative strategy', 'Reporting avanc√©', '2 calls/mois', 'Support prioritaire'], recommended: 'Budgets > 10000‚Ç¨/mois', color: 'purple', budgetBased: true }
        ]
      },
      {
        id: 'creatifs_social',
        title: 'D. Cr√©ation de Cr√©atifs',
        description: 'Production de visuels et vid√©os publicitaires optimis√©s pour les r√©seaux sociaux.',
        icon: 'üé®',
        detailedInfo: {
          title: 'Cr√©ation de Cr√©atifs - C\'est quoi exactement ?',
          content: {
            intro: 'La production de contenus publicitaires (images, vid√©os, carrousels) optimis√©s pour chaque plateforme.',
            sections: [
              {
                title: 'Ce que nous produisons',
                items: [
                  'Visuels statiques (formats story, feed, square)',
                  'Carrousels engageants',
                  'Vid√©os courtes (Reels, TikTok, Stories)',
                  'UGC-style content',
                  'D√©clinaisons pour tests A/B'
                ]
              },
              {
                title: 'Notre process',
                items: [
                  'Brief cr√©atif et moodboard',
                  'Proposition de concepts',
                  'Production et retouches',
                  '2 rounds de r√©visions inclus'
                ]
              }
            ],
            conclusion: 'Livrable : Pack de cr√©atifs pr√™ts √† √™tre upload√©s avec specs par plateforme.'
          }
        },
        roiInfo: {
          title: 'üéØ Ce que √ßa vous apporte',
          content: {
            intro: 'Les cr√©atifs sont responsables de 50-70% de la performance d\'une campagne Social.',
            sections: [
              {
                title: 'Impact des cr√©atifs sur les performances',
                items: [
                  'Un bon cr√©atif peut diviser le CPM par 2',
                  'Les vid√©os g√©n√®rent 20-30% plus d\'engagement',
                  'Le format UGC am√©liore le CTR de 40%',
                  'La vari√©t√© des cr√©atifs prolonge la dur√©e de vie des campagnes'
                ]
              },
              {
                title: 'Pourquoi externaliser',
                items: [
                  'Expertise des formats et best practices par plateforme',
                  'Production rapide et scalable',
                  'Tests A/B syst√©matiques pour trouver les gagnants',
                  'Pas besoin de recruter un graphiste interne'
                ]
              }
            ],
            conclusion: '‚Üí Investir dans les cr√©atifs est souvent plus rentable qu\'augmenter le budget pub.'
          }
        },
        levels: [
          { name: '5 cr√©atifs', price: 300, features: ['5 visuels statiques', 'Formats multiples', '2 r√©visions'], recommended: 'Test et d√©marrage', color: 'blue' },
          { name: '10 cr√©atifs', price: 500, features: ['10 visuels (statiques + carrousels)', 'Tous formats', 'Brief strat√©gique'], recommended: 'Rotation r√©guli√®re', color: 'indigo', popular: true },
          { name: '15 cr√©atifs + vid√©os', price: 900, features: ['10 visuels + 5 vid√©os', 'UGC-style', 'Storyboard inclus', 'Musique licens√©e'], recommended: 'Performance maximale', color: 'purple' }
        ]
      },
      {
        id: 'reporting_social',
        title: 'E. Reporting & Analytics',
        description: 'Dashboards personnalis√©s pour suivre vos performances Social Ads en temps r√©el.',
        icon: 'üìä',
        detailedInfo: {
          title: 'Reporting Social - C\'est quoi exactement ?',
          content: {
            intro: 'Des dashboards centralis√©s pour visualiser les performances de toutes vos campagnes Social.',
            sections: [
              {
                title: 'Ce que nous mettons en place',
                items: [
                  'Dashboard Looker Studio multi-plateformes',
                  'Consolidation Meta + LinkedIn + TikTok',
                  'Int√©gration avec Google Analytics',
                  'Visualisation du funnel complet'
                ]
              },
              {
                title: 'M√©triques suivies',
                items: [
                  'ROAS, CPA, CPM par plateforme et campagne',
                  'Engagement (likes, comments, shares)',
                  'Attribution et parcours client',
                  'Comparaisons p√©riode vs p√©riode'
                ]
              }
            ],
            conclusion: 'Livrable : Dashboard en temps r√©el + alertes automatiques.'
          }
        },
        roiInfo: {
          title: 'üìà Ce que √ßa vous apporte',
          content: {
            intro: 'Une vision unifi√©e de vos performances pour prendre les bonnes d√©cisions.',
            sections: [
              {
                title: 'B√©n√©fices du reporting centralis√©',
                items: [
                  'Plus de temps perdu √† compiler des exports',
                  'Vue d\'ensemble cross-platform instantan√©e',
                  'Identification rapide des campagnes √† scaler/couper',
                  'Donn√©es fiables pour convaincre la direction'
                ]
              },
              {
                title: 'Gains concrets',
                items: [
                  '2-4h/semaine √©conomis√©es sur le reporting',
                  'R√©activit√© accrue face aux anomalies',
                  'Meilleure allocation budg√©taire entre plateformes'
                ]
              }
            ],
            conclusion: '‚Üí Un bon reporting transforme les donn√©es en d√©cisions rentables.'
          }
        },
        levels: [
          { name: 'Essentiel', price: 150, features: ['Dashboard standard', 'KPIs principaux', '1 plateforme'], recommended: 'Suivi basique', color: 'blue' },
          { name: 'Avanc√©', price: 300, features: ['Dashboard personnalis√©', 'Multi-plateformes', 'Alertes automatiques', 'Attribution avanc√©e'], recommended: 'Pilotage multi-canal', color: 'indigo', popular: true }
        ]
      }
    ]);

    // Map services by domain
    const servicesByDomain = Object.freeze({
      [DOMAINS.SEO]: seoServices,
      [DOMAINS.GOOGLE_ADS]: googleAdsServices,
      [DOMAINS.PAID_SOCIAL]: paidSocialServices
    });

    const setupOptions = Object.freeze([
      { id: 'tracking', name: 'Tracking & Measurement Setup', description: 'GA4, GTM, conversions, Meta Pixel, Cookie Banner', price: 750 },
      { id: 'dashboard', name: 'Dashboard Looker Studio', description: 'Reporting visuel en temps r√©el', price: 500 }
    ]);

    // Performance: Static color style definitions moved outside component
    const LEVEL_CARD_COLORS = Object.freeze({
      blue: Object.freeze({
        selected: 'border-blue-500 ring-2 ring-blue-500 bg-blue-50',
        unselected: 'border-blue-200 hover:border-blue-400',
        badge: 'bg-blue-100 text-blue-700'
      }),
      indigo: Object.freeze({
        selected: 'border-indigo-500 ring-2 ring-indigo-500 bg-indigo-50',
        unselected: 'border-indigo-200 hover:border-indigo-400',
        badge: 'bg-indigo-100 text-indigo-700'
      }),
      purple: Object.freeze({
        selected: 'border-purple-500 ring-2 ring-purple-500 bg-purple-50',
        unselected: 'border-purple-200 hover:border-purple-400',
        badge: 'bg-purple-100 text-purple-700'
      })
    });

    // Performance: Memoized component to prevent unnecessary re-renders
    const LevelCard = memo(function LevelCard({ level, isSelected, onSelect, disabled, isOneOff }) {
      const colorConfig = LEVEL_CARD_COLORS[level.color] || LEVEL_CARD_COLORS.blue;
      const borderClass = isSelected ? colorConfig.selected : colorConfig.unselected;

      return (
        <div onClick={disabled ? undefined : onSelect} className={`level-card relative p-5 rounded-xl border-2 transition-all duration-200 ${disabled ? 'cursor-not-allowed opacity-50' : 'cursor-pointer'} ${borderClass}`}>
          {level.popular && !disabled && (
            <span className="absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-xs font-semibold rounded-full whitespace-nowrap">
              Populaire
            </span>
          )}

          <div className="flex items-center justify-between mb-3">
            <h4 className="font-semibold text-gray-900">{level.name}</h4>
            {isSelected && !disabled && (
              <div className={`w-6 h-6 rounded-full flex items-center justify-center ${colorConfig.badge}`}>
                <CheckIcon />
              </div>
            )}
          </div>

          <div className="mb-4">
            {level.budgetBased ? (
              <>
                <span className="text-2xl font-bold text-gray-900">{level.price > 0 ? `+${level.price}‚Ç¨` : 'Inclus'}</span>
                <span className="text-gray-500 text-sm"> + frais de gestion</span>
              </>
            ) : (
              <>
                <span className="text-2xl font-bold text-gray-900">{level.priceNote || `${level.price}‚Ç¨`}</span>
                <span className="text-gray-500 text-sm">{isOneOff ? ' (une fois)' : '/mois'}</span>
              </>
            )}
          </div>

          <ul className="space-y-2 mb-4">
            {level.features.map((feature, featureIdx) => (
              <li key={`${level.name}-feature-${featureIdx}-${feature.slice(0, 15)}`} className="flex items-start gap-2 text-sm text-gray-600">
                <span className="text-green-500 mt-0.5 flex-shrink-0"><CheckIcon /></span>
                {feature}
              </li>
            ))}
          </ul>

          <div className={`text-xs px-3 py-2 rounded-lg ${colorConfig.badge} inline-flex items-center gap-1`}>
            <span className="flex-shrink-0"><InfoIcon /></span>
            <span>{level.recommended}</span>
          </div>

          {level.footnote && (
            <p className="mt-3 text-xs text-gray-500 italic">{level.footnote}</p>
          )}
        </div>
      );
    });

    // Domain Selection Component
    const DomainSelector = memo(function DomainSelector({ selectedDomains, onToggleDomain, onContinue }) {
      const domains = [DOMAINS.SEO, DOMAINS.GOOGLE_ADS, DOMAINS.PAID_SOCIAL];

      const domainColors = {
        [DOMAINS.SEO]: { selected: 'border-indigo-500 bg-indigo-50 ring-2 ring-indigo-500', unselected: 'border-gray-200 hover:border-indigo-300', badge: 'bg-indigo-100 text-indigo-700' },
        [DOMAINS.GOOGLE_ADS]: { selected: 'border-blue-500 bg-blue-50 ring-2 ring-blue-500', unselected: 'border-gray-200 hover:border-blue-300', badge: 'bg-blue-100 text-blue-700' },
        [DOMAINS.PAID_SOCIAL]: { selected: 'border-purple-500 bg-purple-50 ring-2 ring-purple-500', unselected: 'border-gray-200 hover:border-purple-300', badge: 'bg-purple-100 text-purple-700' }
      };

      const hasSelection = selectedDomains.length > 0;

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4">
          <div className="max-w-4xl w-full">
            {/* Header */}
            <div className="text-center mb-8">
              <a href="https://www.mydigipal.com/fr" target="_blank" rel="noopener noreferrer" className="inline-block mb-6">
                <img src="https://cdn.prod.website-files.com/64ec8901e801c89308b10a5b/65f06634783f8c20e2918f0d_01_Main%20.svg" alt="MyDigipal" className="h-12 w-auto" />
              </a>
              <div className="inline-flex items-center gap-2 px-4 py-2 bg-indigo-100 text-indigo-700 rounded-full text-sm font-medium mb-4">
                <SparklesIcon /> Simulateur Marketing Digital
              </div>
              <h1 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Composez votre offre sur-mesure</h1>
              <p className="text-lg text-gray-600 max-w-2xl mx-auto">
                S√©lectionnez les domaines qui vous int√©ressent. Vous pouvez en choisir plusieurs pour une strat√©gie compl√®te.
              </p>
            </div>

            {/* Domain Cards */}
            <div className="grid md:grid-cols-3 gap-6 mb-8">
              {domains.map(domainId => {
                const config = domainConfig[domainId];
                const isSelected = selectedDomains.includes(domainId);
                const colors = domainColors[domainId];

                return (
                  <div
                    key={domainId}
                    onClick={() => onToggleDomain(domainId)}
                    className={`relative p-6 rounded-2xl border-2 cursor-pointer transition-all duration-200 bg-white ${isSelected ? colors.selected : colors.unselected}`}
                  >
                    <div className="text-center">
                      <span className="text-5xl mb-4 block">{config.icon}</span>
                      <h3 className="text-xl font-bold text-gray-900 mb-2">{config.name}</h3>
                      <p className="text-gray-600 text-sm">{config.description}</p>
                    </div>

                    {isSelected && (
                      <div className={`absolute -top-3 -right-3 w-8 h-8 rounded-full flex items-center justify-center ${colors.badge}`}>
                        <CheckIcon />
                      </div>
                    )}
                  </div>
                );
              })}
            </div>

            {/* Info box for multi-selection */}
            <div className="bg-white rounded-xl p-4 mb-8 border border-gray-200">
              <div className="flex items-start gap-3">
                <span className="text-blue-500 mt-0.5"><InfoIcon /></span>
                <div>
                  <p className="text-sm text-gray-700">
                    <strong>Conseil :</strong> Une strat√©gie marketing efficace combine souvent plusieurs canaux.
                    Le SEO construit votre visibilit√© long terme tandis que Google Ads et Social Ads g√©n√®rent des r√©sultats imm√©diats.
                  </p>
                </div>
              </div>
            </div>

            {/* Continue Button */}
            <div className="text-center">
              <button
                onClick={onContinue}
                disabled={!hasSelection}
                className={`px-8 py-4 rounded-xl font-semibold text-lg transition-all flex items-center gap-2 mx-auto ${
                  hasSelection
                    ? 'bg-indigo-600 text-white hover:bg-indigo-700'
                    : 'bg-gray-200 text-gray-400 cursor-not-allowed'
                }`}
              >
                Configurer mes services <ArrowRightIcon />
              </button>
              {!hasSelection && (
                <p className="mt-3 text-sm text-gray-500">S√©lectionnez au moins un domaine pour continuer</p>
              )}
            </div>
          </div>
        </div>
      );
    });

    // Budget Slider Component for Ads
    const BudgetSlider = memo(function BudgetSlider({ domain, budget, onBudgetChange, managementFee }) {
      const config = domainConfig[domain];
      const feeConfig = MANAGEMENT_FEE_CONFIG[domain];

      const handleChange = useCallback((e) => {
        onBudgetChange(domain, parseInt(e.target.value));
      }, [domain, onBudgetChange]);

      return (
        <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 fade-in">
          <div className="flex items-center gap-3 mb-4">
            <span className="text-3xl">{config.icon}</span>
            <div>
              <h3 className="text-xl font-bold text-gray-900">Budget publicitaire {config.name}</h3>
              <p className="text-sm text-gray-600">D√©finissez votre budget mensuel de d√©penses publicitaires</p>
            </div>
          </div>

          <div className="mb-6">
            <div className="flex justify-between items-center mb-2">
              <span className="text-sm text-gray-600">Budget mensuel</span>
              <span className="text-2xl font-bold text-gray-900">{budget.toLocaleString()}‚Ç¨/mois</span>
            </div>
            <input
              type="range"
              min={BUDGET_CONFIG.min}
              max={BUDGET_CONFIG.max}
              step={BUDGET_CONFIG.step}
              value={budget}
              onChange={handleChange}
              className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"
            />
            <div className="flex justify-between text-xs text-gray-400 mt-1">
              <span>{BUDGET_CONFIG.min.toLocaleString()}‚Ç¨</span>
              <span>{BUDGET_CONFIG.max.toLocaleString()}‚Ç¨</span>
            </div>
          </div>

          <div className="bg-indigo-50 rounded-xl p-4">
            <div className="flex justify-between items-center">
              <div>
                <p className="text-sm text-indigo-700 font-medium">Frais de gestion calcul√©s</p>
                <p className="text-xs text-indigo-600">{feeConfig.percentage}% du budget (min. {feeConfig.minimum}‚Ç¨)</p>
              </div>
              <span className="text-xl font-bold text-indigo-700">{managementFee}‚Ç¨/mois</span>
            </div>
          </div>
        </div>
      );
    });

    // Performance: Memoized component with useCallback for stable event handlers
    const ServiceSection = memo(function ServiceSection({ service, selection, onSelect, onDisable, isDisabled, cmsAddon, onToggleCmsAddon, managementFee }) {
      const [showDetails, setShowDetails] = useState(false);
      const [showRoi, setShowRoi] = useState(false);

      // Performance: useCallback to prevent function recreation on each render
      // Fixed closure pattern by using functional state updates
      const toggleDetails = useCallback(() => {
        setShowDetails(prev => {
          if (!prev) setShowRoi(false);
          return !prev;
        });
      }, []);

      const toggleRoi = useCallback(() => {
        setShowRoi(prev => {
          if (!prev) setShowDetails(false);
          return !prev;
        });
      }, []);

      // Performance: Memoize the disable handler to prevent new function on each render
      const handleDisable = useCallback(() => {
        onDisable(service.id);
      }, [onDisable, service.id]);

      // Performance: Memoize level select handlers to prevent new function on each render
      const handleLevelSelect = useCallback((levelIdx) => {
        onSelect(service.id, levelIdx);
      }, [onSelect, service.id]);

      return (
        <div className={`bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 fade-in ${isDisabled ? 'disabled-section' : ''}`}>
          {/* Header avec titre */}
          <div className="flex items-start justify-between mb-3">
            <div className="flex items-center gap-3">
              <span className="text-3xl">{service.icon}</span>
              <div>
                <h3 className="text-xl font-bold text-gray-900">{service.title}</h3>
                {service.isOneOff && (
                  <span className="text-xs px-2 py-1 bg-amber-100 text-amber-700 rounded-full font-medium">Prestation ponctuelle</span>
                )}
              </div>
            </div>
          </div>

          <p className="text-gray-600 mb-4">{service.description}</p>

          {/* 3 boutons align√©s */}
          <div className="flex flex-wrap items-center gap-2 mb-4">
            {/* Bouton C'est quoi exactement ? */}
            <button
              onClick={toggleDetails}
              className={`px-4 py-2 text-sm font-medium rounded-lg flex items-center gap-1 transition-colors ${
                showDetails
                  ? 'bg-indigo-600 text-white'
                  : 'bg-indigo-100 text-indigo-700 hover:bg-indigo-200'
              }`}
            >
              <span>C'est quoi exactement ?</span>
              <span className={`transform transition-transform ${showDetails ? 'rotate-180' : ''}`}>
                <ChevronDownIcon />
              </span>
            </button>

            {/* Bouton √áa m'apporte quoi ? */}
            <button
              onClick={toggleRoi}
              className={`px-4 py-2 text-sm font-medium rounded-lg flex items-center gap-1 transition-colors ${
                showRoi
                  ? 'bg-emerald-600 text-white'
                  : 'bg-emerald-100 text-emerald-700 hover:bg-emerald-200'
              }`}
            >
              <span>√áa m'apporte quoi ?</span>
              <span className={`transform transition-transform ${showRoi ? 'rotate-180' : ''}`}>
                <ChevronDownIcon />
              </span>
            </button>

            {/* Bouton Non merci */}
            <button
              onClick={handleDisable}
              className={`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${
                isDisabled
                  ? 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  : 'bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-700'
              }`}
            >
              {isDisabled ? (
                <>
                  <CheckIcon /> R√©activer
                </>
              ) : (
                <>
                  <XIcon /> Non merci
                </>
              )}
            </button>
          </div>

          {/* Section d√©tails "C'est quoi exactement ?" */}
          {showDetails && (
            <div className="mb-6 p-4 bg-indigo-50 rounded-xl border border-indigo-100 fade-in">
              <h4 className="font-semibold text-indigo-900 mb-3">{service.detailedInfo.title}</h4>
              <FormattedContent content={service.detailedInfo.content} variant="default" />
            </div>
          )}

          {/* Section ROI "√áa m'apporte quoi ?" */}
          {showRoi && (
            <div className="mb-6 p-4 bg-emerald-50 rounded-xl border border-emerald-100 fade-in">
              <h4 className="font-semibold text-emerald-900 mb-3">{service.roiInfo.title}</h4>
              <FormattedContent content={service.roiInfo.content} variant="roi" />
            </div>
          )}

          {/* Cartes des niveaux */}
          {!isDisabled && (
            <>
              <div className={`grid gap-4 ${service.levels.length === 2 ? 'md:grid-cols-2' : 'md:grid-cols-3'}`}>
                {service.levels.map((level, idx) => (
                  <LevelCard
                    key={`${service.id}-level-${level.name}`}
                    level={level}
                    isSelected={selection === idx}
                    onSelect={() => handleLevelSelect(idx)}
                    disabled={isDisabled}
                    isOneOff={service.isOneOff}
                  />
                ))}
              </div>

              {/* Affichage des frais de gestion pour services bas√©s sur budget */}
              {service.hasBudgetFee && selection !== null && managementFee > 0 && (
                <div className="mt-4 p-4 bg-amber-50 rounded-xl border border-amber-200">
                  <div className="flex items-center justify-between">
                    <div>
                      <p className="font-medium text-amber-900">Frais de gestion inclus</p>
                      <p className="text-sm text-amber-700">Bas√©s sur votre budget publicitaire</p>
                    </div>
                    <span className="text-lg font-bold text-amber-900">+{managementFee}‚Ç¨/mois</span>
                  </div>
                </div>
              )}

              {/* Option CMS pour Contenu IA */}
              {service.hasAddon && selection !== null && (
                <div
                  onClick={onToggleCmsAddon}
                  className={`mt-4 p-4 rounded-xl border-2 cursor-pointer transition-all ${
                    cmsAddon
                      ? 'border-green-500 bg-green-50 ring-2 ring-green-500'
                      : 'border-gray-200 hover:border-gray-300'
                  }`}
                >
                  <div className="flex items-center justify-between">
                    <div>
                      <h4 className="font-semibold text-gray-900 flex items-center gap-2">
                        üì§ Publication directe dans le CMS
                        <span className="text-sm font-normal text-green-600">+100‚Ç¨/mois</span>
                      </h4>
                      <p className="text-sm text-gray-600">Push automatique dans WordPress/Webflow (brouillon ou publi√©)</p>
                    </div>
                    <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                      cmsAddon ? 'bg-green-500 border-green-500 text-white' : 'border-gray-300'
                    }`}>
                      {cmsAddon && <CheckIcon />}
                    </div>
                  </div>
                </div>
              )}

              {selection === null && (
                <p className="mt-4 text-sm text-gray-400 text-center">
                  Cliquez sur un niveau pour l'ajouter √† votre devis
                </p>
              )}
            </>
          )}

          {/* Message quand d√©sactiv√© */}
          {isDisabled && (
            <div className="py-8 text-center">
              <p className="text-gray-500">Ce service n'est pas inclus dans votre devis</p>
              <p className="text-sm text-gray-400 mt-1">Cliquez sur "R√©activer" pour l'ajouter</p>
            </div>
          )}
        </div>
      );
    });

    // Performance: Utility function for API retry with exponential backoff
    const fetchWithRetry = async (url, options, maxRetries = 3) => {
      for (let attempt = 0; attempt < maxRetries; attempt++) {
        try {
          const response = await fetch(url, options);
          if (response.ok) return response;
          // Don't retry on client errors (4xx)
          if (response.status >= 400 && response.status < 500) {
            throw new Error(`Client error: ${response.status}`);
          }
        } catch (error) {
          if (attempt === maxRetries - 1) throw error;
          // Exponential backoff: 1s, 2s, 4s
          await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));
        }
      }
      throw new Error('Max retries exceeded');
    };

    // Helper: Calculate management fee based on budget
    const calculateManagementFee = (domain, budget) => {
      const config = MANAGEMENT_FEE_CONFIG[domain];
      if (!config) return 0;
      const percentageFee = Math.round(budget * (config.percentage / 100));
      return Math.max(percentageFee, config.minimum);
    };

    // Helper: Generate initial state for domain services
    const generateInitialSelections = (domains) => {
      const selections = {};
      const disabled = {};
      domains.forEach(domain => {
        const services = servicesByDomain[domain] || [];
        services.forEach(service => {
          selections[service.id] = null;
          disabled[service.id] = false;
        });
      });
      return { selections, disabled };
    };

    // Composant principal - Calculateur Marketing Multi-Domaines
    function MarketingCalculator() {
      // Step management
      const [currentStep, setCurrentStep] = useState('domains'); // 'domains' | 'services'
      const [selectedDomains, setSelectedDomains] = useState([]);

      // Service selections (dynamic based on selected domains)
      const [selections, setSelections] = useState({});
      const [disabledServices, setDisabledServices] = useState({});

      // Ads budgets
      const [adBudgets, setAdBudgets] = useState({
        [DOMAINS.GOOGLE_ADS]: BUDGET_CONFIG.default,
        [DOMAINS.PAID_SOCIAL]: BUDGET_CONFIG.default
      });

      // Common state
      const [cmsAddon, setCmsAddon] = useState(false);
      const [setupSelections, setSetupSelections] = useState({ tracking: false, dashboard: false });
      const [duration, setDuration] = useState(4);
      const [showResult, setShowResult] = useState(false);
      const [contactInfo, setContactInfo] = useState({ name: '', email: '', company: '' });
      const [formSubmitted, setFormSubmitted] = useState(false);
      const [isSubmitting, setIsSubmitting] = useState(false);

      // Domain selection handlers
      const handleToggleDomain = useCallback((domainId) => {
        setSelectedDomains(prev => {
          if (prev.includes(domainId)) {
            return prev.filter(d => d !== domainId);
          }
          return [...prev, domainId];
        });
      }, []);

      const handleContinueFromDomains = useCallback(() => {
        // Initialize selections for selected domains
        const { selections: initSelections, disabled: initDisabled } = generateInitialSelections(selectedDomains);
        setSelections(initSelections);
        setDisabledServices(initDisabled);
        setCurrentStep('services');
      }, [selectedDomains]);

      const handleBackToDomains = useCallback(() => {
        setCurrentStep('domains');
      }, []);

      // Budget handler
      const handleBudgetChange = useCallback((domain, budget) => {
        setAdBudgets(prev => ({ ...prev, [domain]: budget }));
      }, []);

      // Calculate management fees for each domain
      const managementFees = useMemo(() => {
        const fees = {};
        [DOMAINS.GOOGLE_ADS, DOMAINS.PAID_SOCIAL].forEach(domain => {
          if (selectedDomains.includes(domain)) {
            fees[domain] = calculateManagementFee(domain, adBudgets[domain]);
          }
        });
        return fees;
      }, [selectedDomains, adBudgets]);

      // Performance: useCallback to prevent function recreation on each render
      const handleSelect = useCallback((serviceId, levelIdx) => {
        setSelections(prev => {
          const newSelections = { ...prev, [serviceId]: prev[serviceId] === levelIdx ? null : levelIdx };
          // Handle CMS addon reset when deselecting contenu
          if (serviceId === 'contenu' && prev[serviceId] === levelIdx) {
            setCmsAddon(false);
          }
          return newSelections;
        });
      }, []);

      const handleDisable = useCallback((serviceId) => {
        setDisabledServices(prev => {
          const newDisabled = !prev[serviceId];
          if (newDisabled) {
            setSelections(prevSel => ({ ...prevSel, [serviceId]: null }));
            if (serviceId === 'contenu') {
              setCmsAddon(false);
            }
          }
          return { ...prev, [serviceId]: newDisabled };
        });
      }, []);

      const toggleSetup = useCallback((id) => {
        setSetupSelections(prev => ({ ...prev, [id]: !prev[id] }));
      }, []);

      const handleToggleCmsAddon = useCallback(() => {
        setCmsAddon(prev => !prev);
      }, []);

      const handleShowResult = useCallback(() => {
        setShowResult(true);
      }, []);

      const handleCloseResult = useCallback(() => {
        setShowResult(false);
      }, []);

      const handleDurationChange = useCallback((d) => {
        setDuration(d);
      }, []);

      const handleContactChange = useCallback((field, value) => {
        setContactInfo(prev => ({ ...prev, [field]: value }));
      }, []);

      // Performance: Split useMemo into smaller focused memos for better granularity
      // Memo 1: Calculate selected services by domain (depends on selections, disabledServices, cmsAddon, managementFees)
      const selectedServicesByDomain = useMemo(() => {
        const byDomain = {};

        selectedDomains.forEach(domain => {
          const domainServices = servicesByDomain[domain] || [];
          const selected = [];

          domainServices.forEach(service => {
            const levelIdx = selections[service.id];
            const isDisabled = disabledServices[service.id];

            if (levelIdx != null && !isDisabled) {
              const level = service.levels[levelIdx];

              // Calculate management fee for budget-based services
              let managementFee = 0;
              if (service.hasBudgetFee && level.budgetBased) {
                managementFee = managementFees[domain] || 0;
              }

              if (service.isOneOff) {
                selected.push({
                  id: service.id,
                  domain: domain,
                  service: service.title,
                  level: level.name,
                  price: level.price,
                  features: level.features,
                  isOneOff: true
                });
              } else {
                selected.push({
                  id: service.id,
                  domain: domain,
                  service: service.title,
                  level: level.name,
                  price: level.price,
                  managementFee: managementFee,
                  levelExtra: level.price, // Extra price on top of management fee
                  cmsAddon: service.id === 'contenu' && cmsAddon ? 100 : 0,
                  features: service.id === 'contenu' && cmsAddon
                    ? [...level.features, 'Publication directe CMS']
                    : level.features,
                  isOneOff: false,
                  hasBudgetFee: service.hasBudgetFee && level.budgetBased
                });
              }
            }
          });

          byDomain[domain] = selected;
        });

        return byDomain;
      }, [selectedDomains, selections, disabledServices, cmsAddon, managementFees]);

      // Flatten all selected services
      const selectedServices = useMemo(() => {
        return Object.values(selectedServicesByDomain).flat();
      }, [selectedServicesByDomain]);

      // Memo 2: Calculate setup services (depends only on setupSelections)
      const selectedSetupServices = useMemo(() => {
        const selectedSetup = [];
        setupOptions.forEach(opt => {
          if (setupSelections[opt.id]) {
            selectedSetup.push({
              id: opt.id,
              service: 'F. Tracking et Reporting',
              name: opt.name,
              price: opt.price,
              isOneOff: true
            });
          }
        });
        return selectedSetup;
      }, [setupSelections]);

      // Memo 3: Calculate totals (depends on selectedServices, selectedSetupServices)
      const { monthlyTotal, oneOffTotal, setupTotal, totalManagementFees } = useMemo(() => {
        let monthly = 0;
        let oneOff = 0;
        let setup = 0;
        let managementFeesTotal = 0;

        selectedServices.forEach(item => {
          if (item.isOneOff) {
            oneOff += item.price;
          } else {
            // For budget-based services, add management fee + level extra price
            if (item.hasBudgetFee) {
              managementFeesTotal += item.managementFee || 0;
              monthly += (item.managementFee || 0) + (item.levelExtra || 0);
            } else {
              monthly += item.price + (item.cmsAddon || 0);
            }
          }
        });

        selectedSetupServices.forEach(item => {
          setup += item.price;
        });

        return { monthlyTotal: monthly, oneOffTotal: oneOff, setupTotal: setup, totalManagementFees: managementFeesTotal };
      }, [selectedServices, selectedSetupServices]);

      // Memo 4: Calculate discount (depends on monthlyTotal, duration)
      const discount = useMemo(() => {
        const discountRate = duration === 6 ? 0.05 : 0;
        return monthlyTotal * duration * discountRate;
      }, [monthlyTotal, duration]);

      // Derived calculations (cheap, no memo needed)
      const totalServicesCount = selectedServices.length + selectedSetupServices.length;
      const totalSetup = oneOffTotal + setupTotal;
      const grandTotal = (monthlyTotal * duration) + oneOffTotal + setupTotal - discount;
      const effectiveMonthlyPrice = Math.round(grandTotal / duration);
      const hasSelections = totalServicesCount > 0;

      // Calculate total ad budget
      const totalAdBudget = useMemo(() => {
        let total = 0;
        if (selectedDomains.includes(DOMAINS.GOOGLE_ADS)) {
          total += adBudgets[DOMAINS.GOOGLE_ADS];
        }
        if (selectedDomains.includes(DOMAINS.PAID_SOCIAL)) {
          total += adBudgets[DOMAINS.PAID_SOCIAL];
        }
        return total;
      }, [selectedDomains, adBudgets]);

      // Performance: useCallback for form submission with retry logic
      const handleSubmit = useCallback(async (e) => {
        e.preventDefault();
        if (isSubmitting) return;
        setIsSubmitting(true);

        // Build detailed payload with all domain information
        const payload = {
          // Contact info
          contact: {
            name: contactInfo.name,
            email: contactInfo.email,
            company: contactInfo.company || ''
          },

          // Selected domains
          selectedDomains: selectedDomains.map(d => ({
            id: d,
            name: domainConfig[d].name
          })),

          // Services by domain
          servicesByDomain: Object.fromEntries(
            selectedDomains.map(domain => [
              domainConfig[domain].name,
              (selectedServicesByDomain[domain] || []).map(s => ({
                name: s.service,
                level: s.level,
                basePrice: s.price,
                managementFee: s.managementFee || 0,
                cmsAddon: s.cmsAddon || 0,
                totalPrice: s.isOneOff ? s.price : (s.hasBudgetFee ? (s.managementFee + s.levelExtra) : (s.price + (s.cmsAddon || 0))),
                features: s.features,
                isOneOff: s.isOneOff,
                hasBudgetFee: s.hasBudgetFee || false
              }))
            ])
          ),

          // Ad budgets (for Google Ads and Paid Social)
          adBudgets: {
            googleAds: selectedDomains.includes(DOMAINS.GOOGLE_ADS) ? {
              monthlyBudget: adBudgets[DOMAINS.GOOGLE_ADS],
              managementFee: managementFees[DOMAINS.GOOGLE_ADS] || 0,
              feePercentage: MANAGEMENT_FEE_CONFIG[DOMAINS.GOOGLE_ADS].percentage
            } : null,
            paidSocial: selectedDomains.includes(DOMAINS.PAID_SOCIAL) ? {
              monthlyBudget: adBudgets[DOMAINS.PAID_SOCIAL],
              managementFee: managementFees[DOMAINS.PAID_SOCIAL] || 0,
              feePercentage: MANAGEMENT_FEE_CONFIG[DOMAINS.PAID_SOCIAL].percentage
            } : null,
            totalMonthlyAdBudget: totalAdBudget
          },

          // Setup options
          setupDetails: {
            tracking: setupSelections.tracking ? { name: 'Tracking & Measurement Setup', price: 750 } : null,
            dashboard: setupSelections.dashboard ? { name: 'Dashboard Looker Studio', price: 500 } : null,
            total: setupTotal
          },

          // Financial summary
          financialSummary: {
            duration: duration,
            monthlyServicesTotal: monthlyTotal,
            totalManagementFees: totalManagementFees,
            oneOffServicesTotal: oneOffTotal,
            setupTotal: setupTotal,
            discount: discount,
            grandTotal: grandTotal,
            effectiveMonthlyPrice: effectiveMonthlyPrice
          },

          // Metadata
          metadata: {
            timestamp: new Date().toISOString(),
            source: 'marketing-calculator-v2',
            domainsCount: selectedDomains.length,
            servicesCount: totalServicesCount
          }
        };

        try {
          // Performance: Use retry logic with exponential backoff
          await fetchWithRetry('https://n8n.mydigipal.com:5678/webhook/calculateur-marketing', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          setFormSubmitted(true);
        } catch (error) {
          console.error('Erreur:', error);
          alert('Erreur de connexion. Veuillez r√©essayer.');
          setIsSubmitting(false);
        }
      }, [isSubmitting, contactInfo, selectedDomains, selectedServicesByDomain, adBudgets, managementFees, totalAdBudget, setupSelections, setupTotal, duration, monthlyTotal, totalManagementFees, oneOffTotal, discount, grandTotal, effectiveMonthlyPrice, totalServicesCount]);

      // Domain selection screen
      if (currentStep === 'domains') {
        return (
          <DomainSelector
            selectedDomains={selectedDomains}
            onToggleDomain={handleToggleDomain}
            onContinue={handleContinueFromDomains}
          />
        );
      }

      // Services configuration screen
      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
          {/* Header */}
          <header className="bg-white border-b border-gray-100 sticky top-0 z-50">
            <div className="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <a href="https://www.mydigipal.com/fr" target="_blank" rel="noopener noreferrer">
                  <img src="https://cdn.prod.website-files.com/64ec8901e801c89308b10a5b/65f06634783f8c20e2918f0d_01_Main%20.svg" alt="MyDigipal" className="h-10 w-auto" />
                </a>
                <div className="border-l border-gray-200 pl-3">
                  <p className="text-sm font-medium text-gray-700">Simulateur Marketing Digital</p>
                  <div className="flex gap-1 mt-1">
                    {selectedDomains.map(d => {
                      const cfg = domainConfig[d];
                      if (!cfg) return null;
                      return (
                        <span key={d} className="text-xs px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded-full">
                          {cfg.icon} {cfg.name}
                        </span>
                      );
                    })}
                  </div>
                </div>
              </div>

              <div className="flex items-center gap-3">
                <button onClick={handleBackToDomains} className="text-sm text-gray-500 hover:text-gray-700">
                  ‚Üê Modifier les domaines
                </button>
                {hasSelections && (
                  <div className="hidden md:flex items-center gap-4">
                    <div className="text-right">
                      <p className="text-sm text-gray-500">Estimation</p>
                      <p className="text-xl font-bold text-indigo-600">{effectiveMonthlyPrice}‚Ç¨/mois</p>
                    </div>
                    <button onClick={handleShowResult} className="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition flex items-center gap-2">
                      Voir le r√©capitulatif <ArrowRightIcon />
                    </button>
                  </div>
                )}
              </div>
            </div>
          </header>

          <main className="max-w-6xl mx-auto px-4 py-8">
            {/* Intro */}
            <section className="text-center mb-12">
              <div className="inline-flex items-center gap-2 px-4 py-2 bg-indigo-100 text-indigo-700 rounded-full text-sm font-medium mb-4">
                <SparklesIcon /> Offre modulaire sur-mesure
              </div>
              <h2 className="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Composez votre offre marketing</h2>
              <p className="text-lg text-gray-600 max-w-2xl mx-auto">
                S√©lectionnez le niveau adapt√© pour chaque service ou cliquez sur "Non merci" pour les modules qui ne vous int√©ressent pas.
              </p>
            </section>

            {/* Services by Domain */}
            {selectedDomains.map(domain => {
              const config = domainConfig[domain];
              if (!config) return null;
              const domainServices = servicesByDomain[domain] || [];
              const needsBudgetSlider = domain === DOMAINS.GOOGLE_ADS || domain === DOMAINS.PAID_SOCIAL;

              return (
                <div key={domain} className="mb-12">
                  {/* Domain Header */}
                  <div className="flex items-center gap-3 mb-6 pb-4 border-b-2 border-gray-200">
                    <span className="text-4xl">{config.icon}</span>
                    <div>
                      <h2 className="text-2xl font-bold text-gray-900">{config.name}</h2>
                      <p className="text-gray-600">{config.description}</p>
                    </div>
                  </div>

                  {/* Budget Slider for Ads Domains */}
                  {needsBudgetSlider && (
                    <BudgetSlider
                      domain={domain}
                      budget={adBudgets[domain]}
                      onBudgetChange={handleBudgetChange}
                      managementFee={managementFees[domain] || 0}
                    />
                  )}

                  {/* Domain Services */}
                  {domainServices.map(service => (
                    <ServiceSection
                      key={service.id}
                      service={service}
                      selection={selections[service.id]}
                      onSelect={handleSelect}
                      onDisable={handleDisable}
                      isDisabled={disabledServices[service.id]}
                      cmsAddon={service.id === 'contenu' ? cmsAddon : false}
                      onToggleCmsAddon={handleToggleCmsAddon}
                      managementFee={managementFees[domain] || 0}
                    />
                  ))}
                </div>
              );
            })}

            {/* F. Tracking et Reporting */}
            <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 fade-in">
              <div className="flex items-center gap-3 mb-3">
                <span className="text-3xl">üìä</span>
                <div>
                  <h3 className="text-xl font-bold text-gray-900">F. Tracking et Reporting</h3>
                  <span className="text-xs px-2 py-1 bg-amber-100 text-amber-700 rounded-full font-medium">Prestation ponctuelle</span>
                </div>
              </div>
              <p className="text-gray-600 mb-6">Des prestations ponctuelles pour poser les fondations de votre tracking et visualiser vos performances.</p>
              
              <div className="grid md:grid-cols-2 gap-4">
                {setupOptions.map(opt => (
                  <div key={opt.id} onClick={() => toggleSetup(opt.id)} className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${setupSelections[opt.id] ? 'border-green-500 bg-green-50 ring-2 ring-green-500' : 'border-gray-200 hover:border-gray-300'}`}>
                    <div className="flex items-center justify-between mb-2">
                      <h4 className="font-semibold text-gray-900">{opt.name}</h4>
                      <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${setupSelections[opt.id] ? 'bg-green-500 border-green-500 text-white' : 'border-gray-300'}`}>
                        {setupSelections[opt.id] && <CheckIcon />}
                      </div>
                    </div>
                    <p className="text-sm text-gray-600 mb-2">{opt.description}</p>
                    <p className="text-lg font-bold text-gray-900">{opt.price}‚Ç¨ <span className="text-sm font-normal text-gray-500">(une fois)</span></p>
                  </div>
                ))}
              </div>
            </div>

            {/* Duration */}
            <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 fade-in">
              <div className="flex items-center gap-3 mb-3">
                <span className="text-3xl">üìÖ</span>
                <h3 className="text-xl font-bold text-gray-900">Dur√©e d'engagement</h3>
              </div>

              <div className="grid md:grid-cols-2 gap-4">
                {[4, 6].map(d => (
                  <div key={`duration-${d}`} onClick={() => handleDurationChange(d)} className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${duration === d ? 'border-indigo-500 bg-indigo-50 ring-2 ring-indigo-500' : 'border-gray-200 hover:border-gray-300'}`}>
                    <div className="flex items-center justify-between">
                      <div>
                        <h4 className="font-semibold text-gray-900">{d} mois</h4>
                        <p className="text-sm text-gray-600">{d === 4 ? 'Engagement minimum' : '5% de remise sur les services mensuels'}</p>
                      </div>
                      <div className="flex items-center gap-2">
                        {d === 6 && <span className="px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full">-5%</span>}
                        {duration === d && <div className="w-6 h-6 rounded-full bg-indigo-500 flex items-center justify-center text-white"><CheckIcon /></div>}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Mobile Summary Bar */}
            {hasSelections && (
              <div className="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg z-40">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-500">Estimation</p>
                    <p className="text-xl font-bold text-indigo-600">{effectiveMonthlyPrice}‚Ç¨/mois</p>
                  </div>
                  <button onClick={handleShowResult} className="px-4 py-3 bg-indigo-600 text-white rounded-lg font-medium">
                    Voir le r√©capitulatif
                  </button>
                </div>
              </div>
            )}

            {/* Desktop Summary */}
            {hasSelections && (
              <div className="hidden md:block bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white fade-in">
                <div className="flex items-center justify-between">
                  <div>
                    <h3 className="text-xl font-bold mb-1">Votre estimation</h3>
                    <p className="text-indigo-200">{totalServicesCount} service{totalServicesCount > 1 ? 's' : ''} s√©lectionn√©{totalServicesCount > 1 ? 's' : ''}</p>
                  </div>

                  <div className="text-right">
                    <p className="text-3xl font-bold">
                      {effectiveMonthlyPrice}‚Ç¨/mois
                    </p>
                    <p className="text-indigo-200">pendant {duration} mois</p>
                    {discount > 0 && <p className="text-green-300 text-sm">Remise 6 mois incluse (-{discount.toLocaleString()}‚Ç¨)</p>}
                  </div>

                  <button onClick={handleShowResult} className="px-6 py-3 bg-white text-indigo-600 rounded-xl font-semibold hover:bg-indigo-50 transition flex items-center gap-2">
                    Voir le d√©tail <ChevronRightIcon />
                  </button>
                </div>
              </div>
            )}
          </main>

          {/* Modal R√©capitulatif */}
          {showResult && (
            <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto">
              <div className="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto fade-in">
                <div className="sticky top-0 bg-white border-b border-gray-100 p-6 flex items-center justify-between">
                  <h3 className="text-xl font-bold text-gray-900">Votre devis personnalis√©</h3>
                  <button onClick={handleCloseResult} className="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
                </div>

                <div className="p-6">
                  {totalServicesCount === 0 ? (
                    <p className="text-gray-500 text-center py-8">Aucun service s√©lectionn√©.</p>
                  ) : (
                    <>
                      {/* Services s√©lectionn√©s par domaine */}
                      <div className="space-y-6 mb-6">
                        {selectedDomains.map(domain => {
                          const domainServices = selectedServicesByDomain[domain] || [];
                          if (domainServices.length === 0) return null;
                          const config = domainConfig[domain];
                          if (!config) return null;
                          const hasBudget = domain === DOMAINS.GOOGLE_ADS || domain === DOMAINS.PAID_SOCIAL;

                          return (
                            <div key={domain}>
                              {/* Domain Header */}
                              <div className="flex items-center gap-2 mb-3 pb-2 border-b border-gray-200">
                                <span className="text-xl">{config.icon}</span>
                                <h4 className="font-bold text-gray-900">{config.name}</h4>
                              </div>

                              {/* Budget info for ads domains */}
                              {hasBudget && (
                                <div className="mb-3 p-3 bg-blue-50 rounded-lg">
                                  <div className="flex justify-between items-center text-sm">
                                    <span className="text-blue-700">Budget publicitaire mensuel</span>
                                    <span className="font-bold text-blue-900">{adBudgets[domain].toLocaleString()}‚Ç¨/mois</span>
                                  </div>
                                  <div className="flex justify-between items-center text-sm mt-1">
                                    <span className="text-blue-700">Frais de gestion ({MANAGEMENT_FEE_CONFIG[domain].percentage}%)</span>
                                    <span className="font-bold text-blue-900">{managementFees[domain]}‚Ç¨/mois</span>
                                  </div>
                                </div>
                              )}

                              {/* Domain services */}
                              <div className="space-y-3">
                                {domainServices.map((item) => (
                                  <div key={`selected-${item.id}-${item.level}`} className={`p-4 rounded-xl ${item.isOneOff ? 'bg-amber-50' : 'bg-gray-50'}`}>
                                    <div className="flex items-center justify-between mb-2">
                                      <div>
                                        <h4 className="font-semibold text-gray-900">{item.service}</h4>
                                        <span className="text-sm text-indigo-600 font-medium">
                                          {item.level}
                                          {item.isOneOff && <span className="ml-2 text-amber-600">(ponctuel)</span>}
                                        </span>
                                      </div>
                                      <div className="text-right">
                                        {item.hasBudgetFee ? (
                                          <>
                                            <span className="text-lg font-bold text-gray-900">
                                              {(item.managementFee + item.levelExtra)}‚Ç¨
                                              <span className="text-sm font-normal text-gray-500">/mois</span>
                                            </span>
                                            {item.levelExtra > 0 && (
                                              <p className="text-xs text-blue-600">dont +{item.levelExtra}‚Ç¨ niveau {item.level}</p>
                                            )}
                                          </>
                                        ) : (
                                          <>
                                            <span className="text-lg font-bold text-gray-900">
                                              {item.price + (item.cmsAddon || 0)}‚Ç¨
                                              {!item.isOneOff && <span className="text-sm font-normal text-gray-500">/mois</span>}
                                            </span>
                                            {item.cmsAddon > 0 && (
                                              <p className="text-xs text-green-600">dont +100‚Ç¨ CMS</p>
                                            )}
                                          </>
                                        )}
                                      </div>
                                    </div>
                                    <ul className="text-sm text-gray-600">
                                      {item.features.map((f, featureIdx) => (
                                        <li key={`${item.id}-feature-${featureIdx}-${f.slice(0, 10)}`} className="flex items-center gap-2">
                                          <span className="text-green-500"><CheckIcon /></span> {f}
                                        </li>
                                      ))}
                                    </ul>
                                  </div>
                                ))}
                              </div>
                            </div>
                          );
                        })}

                        {/* F. Tracking et Reporting */}
                        {(setupSelections.tracking || setupSelections.dashboard) && (
                          <div className="p-4 bg-amber-50 rounded-xl">
                            <h4 className="font-semibold text-gray-900 mb-2">Tracking et Reporting <span className="text-amber-600 text-sm font-normal">(ponctuel)</span></h4>
                            {setupSelections.tracking && <div className="flex justify-between text-sm"><span>Tracking & Measurement Setup</span><span className="font-medium">750‚Ç¨</span></div>}
                            {setupSelections.dashboard && <div className="flex justify-between text-sm"><span>Dashboard Looker Studio</span><span className="font-medium">500‚Ç¨</span></div>}
                          </div>
                        )}
                      </div>

                      {/* R√©cap financier simplifi√© */}
                      <div className="border-t border-gray-200 pt-4 mb-6">
                        <div className="flex justify-between mb-2">
                          <span className="text-gray-600">Dur√©e d'engagement</span>
                          <span className="font-semibold">{duration} mois</span>
                        </div>
                        {totalSetup > 0 && (
                          <div className="flex justify-between mb-2">
                            <span className="text-gray-600">Setup</span>
                            <span className="font-semibold">{totalSetup.toLocaleString()}‚Ç¨</span>
                          </div>
                        )}
                        {monthlyTotal > 0 && (
                          <div className="flex justify-between mb-2">
                            <span className="text-gray-600">Prestations mensuelles</span>
                            <span className="font-semibold">{monthlyTotal}‚Ç¨/mois</span>
                          </div>
                        )}
                        {discount > 0 && (
                          <div className="flex justify-between mb-2 text-green-600">
                            <span>Remise engagement 6 mois (-5%)</span>
                            <span className="font-semibold">-{discount.toLocaleString()}‚Ç¨</span>
                          </div>
                        )}
                        <div className="bg-indigo-50 rounded-xl p-4 mt-4">
                          <div className="flex justify-between items-center">
                            <span className="text-lg font-bold text-gray-900">Total</span>
                            <div className="text-right">
                              <span className="text-2xl font-bold text-indigo-600">{effectiveMonthlyPrice}‚Ç¨/mois</span>
                              <p className="text-sm text-gray-600">pendant {duration} mois</p>
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* Les + MyDigipal */}
                      <div className="bg-indigo-50 rounded-xl p-4 mb-6">
                        <h4 className="font-semibold text-indigo-900 mb-2 flex items-center gap-2"><SparklesIcon /> Inclus dans tous nos services</h4>
                        <ul className="text-sm text-indigo-800 space-y-1">
                          <li>‚úì Optimisation LLM (ChatGPT, Perplexity, Copilot)</li>
                          <li>‚úì Outils premium (Ahrefs, Search Console)</li>
                          <li>‚úì Approche 100% data-driven</li>
                          <li>‚úì Transparence totale sur les actions</li>
                        </ul>
                      </div>

                      {/* Contact Form */}
                      <div className="border-t border-gray-200 pt-6">
                        {formSubmitted ? (
                          <div className="text-center py-8">
                            <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                              <span className="text-green-500 text-2xl">‚úì</span>
                            </div>
                            <h4 className="text-xl font-bold text-gray-900 mb-2">Merci !</h4>
                            <p className="text-gray-600">Nous vous recontacterons sous 24h.</p>
                          </div>
                        ) : (
                          <>
                            <h4 className="font-semibold text-gray-900 mb-4">Recevoir ce devis par email</h4>
                            <form onSubmit={handleSubmit} className="space-y-3">
                              <input type="text" placeholder="Votre nom" value={contactInfo.name} onChange={(e) => handleContactChange('name', e.target.value)} required disabled={isSubmitting} className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none disabled:bg-gray-100 disabled:cursor-not-allowed" />
                              <input type="email" placeholder="Votre email" value={contactInfo.email} onChange={(e) => handleContactChange('email', e.target.value)} required disabled={isSubmitting} className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none disabled:bg-gray-100 disabled:cursor-not-allowed" />
                              <input type="text" placeholder="Votre entreprise (optionnel)" value={contactInfo.company} onChange={(e) => handleContactChange('company', e.target.value)} disabled={isSubmitting} className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none disabled:bg-gray-100 disabled:cursor-not-allowed" />
                              <button type="submit" disabled={isSubmitting} className="w-full px-4 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition flex items-center justify-center gap-2 disabled:bg-indigo-400 disabled:cursor-not-allowed">
                                {isSubmitting ? (
                                  <>
                                    <LoaderIcon /> Envoi en cours...
                                  </>
                                ) : (
                                  <>
                                    <MailIcon /> Envoyer le devis
                                  </>
                                )}
                              </button>
                            </form>
                            <p className="text-xs text-gray-500 mt-3 text-center">Nous vous recontacterons sous 24h.</p>
                          </>
                        )}
                      </div>
                    </>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Footer */}
          <footer className="bg-white border-t border-gray-100 py-8 mt-12 mb-20 md:mb-0">
            <div className="max-w-6xl mx-auto px-4 text-center">
              <p className="text-gray-600 mb-2">Des questions ?</p>
              <a href="mailto:paul@mydigipal.com" className="text-indigo-600 font-semibold hover:underline">paul@mydigipal.com</a>
              <p className="mt-4">
                <a href="https://www.mydigipal.com/fr" target="_blank" rel="noopener noreferrer" className="text-gray-500 hover:text-indigo-600 text-sm">www.mydigipal.com</a>
              </p>
            </div>
          </footer>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<MarketingCalculator />);
  </script>
</body>
</html>
